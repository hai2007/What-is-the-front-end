(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{32:function(t,e,n){"use strict";(function(t){
/*!
* Open Web Excel - ✍️ An Excel Used on the Browser Side.
* git+https://github.com/hai2007/Open-Web-Excel.git
*
* author 你好2007
*
* version 0.2.2
*
* Copyright (c) 2021 hai2007 走一步，再走一步。
* Released under the MIT license
*
* Date:Fri Aug 06 2021 18:43:15 GMT+0800 (GMT+08:00)
*/
function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}!function(){var n=Object.prototype.toString;function o(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":n.call(t)}function i(t){if(null===t||"object"!==e(t)||"[object Object]"!=o(t))return!1;if(null===Object.getPrototypeOf(t))return!0;for(var n=t;null!==Object.getPrototypeOf(n);)n=Object.getPrototypeOf(n);return Object.getPrototypeOf(t)===n}var r=function(t){return"number"==typeof t||null!==t&&"object"===e(t)&&"[object Number]"===o(t)},s=function(t){return function(t,n){return null!==n&&"object"===e(n)&&t.indexOf(n.nodeType)>-1&&!i(n)}([1,9,11],t)},a="http://www.w3.org/2000/svg",l={stopPropagation:function(t){(t=t||window.event).stopPropagation?t.stopPropagation():t.cancelBubble=!0},preventDefault:function(t){(t=t||window.event).preventDefault?t.preventDefault():t.returnValue=!1},isNode:function(t){return t&&(1===t.nodeType||9===t.nodeType||11===t.nodeType)},bind:function(t,e,n){if(t.constructor!==Array&&t.constructor!==NodeList&&t.constructor!==HTMLCollection)window.attachEvent?t.attachEvent("on"+e,n):t.addEventListener(e,n,!1);else for(var o=0;o<t.length;o++)this.bind(t[o],e,n)},unbind:function(t,e,n){if(t.constructor!==Array&&t.constructor!==NodeList&&t.constructor!==HTMLCollection)window.detachEvent?t.detachEvent("on"+e,n):t.removeEventListener(e,n,!1);else for(var o=0;o<t.length;o++)this.unbind(t[o],e,n)},find:function(t,e,n){if(!this.isNode(t))return[];for(var o=t.getElementsByTagName(n||"*"),i=[],r=0;r<o.length;r++)this.isNode(o[r])&&("function"!=typeof e||e(o[r]))&&i.push(o[r]);return i},children:function(t,e){for(var n=t.childNodes,o=[],i=0;i<n.length;i++)this.isNode(n[i])&&("function"!=typeof e||e(n[i]))&&o.push(n[i]);return o},hasClass:function(t,e,n){e.constructor!==Array&&(e=[e]);for(var o=" "+(t.getAttribute("class")||"")+" ",i=0;i<e.length;i++)if(o.indexOf(" "+e[i]+" ")>=0){if(n)return!0}else if(!n)return!1;return!0},removeClass:function(t,e){var n=(" "+(t.getAttribute("class")||"")+" ").replace(" "+e.trim()+" "," ");t.setAttribute("class",n.trim())},addClass:function(t,e){if(!this.hasClass(t,e)){var n=t.getAttribute("class")||"";t.setAttribute("class",n+" "+e)}},toNode:function(t,e){var n;if(e)n=document.createElementNS(a,"svg");else{var o="div";/^<tr[> ]/.test(t)?o="tbody":/^<th[> ]/.test(t)||/^<td[> ]/.test(t)?o="tr":(/^<thead[> ]/.test(t)||/^<tbody[> ]/.test(t))&&(o="table"),n=document.createElement(o)}n.innerHTML=t;for(var i=n.childNodes,r=0;r<i.length;r++)if(this.isNode(i[r]))return i[r]},trigger:function(t,e){if(document.createEventObject)t.fireEvent("on"+e,document.createEventObject());else{var n=document.createEvent("HTMLEvents");n.initEvent(e,!0,!1),t.dispatchEvent(n)}},getStyle:function(t,e){var n=document.defaultView&&document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(t,null):t.currentStyle;return"string"==typeof e?n.getPropertyValue(e):n},offsetPosition:function(t){var e=0,n=0;for(n=t.offsetTop,e=t.offsetLeft,t=t.offsetParent;t;)n+=t.offsetTop,e+=t.offsetLeft,t=t.offsetParent;return{left:e,top:n}},mousePosition:function(t,e){var n=t.getBoundingClientRect();if(!e||!e.clientX)throw new Error("Event is necessary!");return{x:e.clientX-n.left,y:e.clientY-n.top}},remove:function(t){t.parentNode.removeChild(t)},setStyles:function(t,e){for(var n in e)t.style[n]=e[n]},size:function(t,e){var n,o;return"content"==e?(o=t.clientWidth-(this.getStyle(t,"padding-left")+"").replace("px","")-(this.getStyle(t,"padding-right")+"").replace("px",""),n=t.clientHeight-(this.getStyle(t,"padding-top")+"").replace("px","")-(this.getStyle(t,"padding-bottom")+"").replace("px","")):"padding"==e?(o=t.clientWidth,n=t.clientHeight):"border"==e?(o=t.offsetWidth,n=t.offsetHeight):"scroll"==e?(o=t.scrollWidth,n=t.scrollHeight):(o=t.offsetWidth,n=t.offsetHeight),{width:o,height:n}},append:function(t,e){var n=this.isNode(e)?e:this.toNode(e);return t.appendChild(n),n},prepend:function(t,e){var n=this.isNode(e)?e:this.toNode(e);return t.insertBefore(n,t.childNodes[0]),n},after:function(t,e){var n=this.isNode(e)?e:this.toNode(e);return t.parentNode.insertBefore(n,t.nextSibling),n},before:function(t,e){var n=this.isNode(e)?e:this.toNode(e);return t.parentNode.insertBefore(n,t),n}};function c(t){var e=t||window.event;return e.target||e.srcElement}function p(t){var e=t.parentNode;e&&e.removeChild(t)}var _=function(t,e){for(var n=0;n<t.__contentDom.length;n++)n==e?(l.setStyles(t.__contentDom[n],{display:"table"}),t.__btnDom[n].setAttribute("active","yes")):(l.setStyles(t.__contentDom[n],{display:"none"}),t.__btnDom[n].setAttribute("active","no"));t.__tableIndex=e,t.$$moveCursorTo(t.__contentDom[e].getElementsByTagName("tr")[1].getElementsByTagName("th")[1],1,1)};var d={48:[0,")"],49:[1,"!"],50:[2,"@"],51:[3,"#"],52:[4,"$"],53:[5,"%"],54:[6,"^"],55:[7,"&"],56:[8,"*"],57:[9,"("],96:[0,0],97:1,98:2,99:3,100:4,101:5,102:6,103:7,104:8,105:9,106:"*",107:"+",109:"-",110:".",111:"/",65:["a","A"],66:["b","B"],67:["c","C"],68:["d","D"],69:["e","E"],70:["f","F"],71:["g","G"],72:["h","H"],73:["i","I"],74:["j","J"],75:["k","K"],76:["l","L"],77:["m","M"],78:["n","N"],79:["o","O"],80:["p","P"],81:["q","Q"],82:["r","R"],83:["s","S"],84:["t","T"],85:["u","U"],86:["v","V"],87:["w","W"],88:["x","X"],89:["y","Y"],90:["z","Z"],37:"left",38:"up",39:"right",40:"down",33:"page up",34:"page down",35:"end",36:"home",16:"shift",17:"ctrl",18:"alt",91:"command",92:"command",93:"command",9:"tab",20:"caps lock",32:"spacebar",8:"backspace",13:"enter",27:"esc",46:"delete",45:"insert",144:"number lock",145:"scroll lock",12:"clear",19:"pause",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",189:["-","_"],187:["=","+"],219:["[","{"],221:["]","}"],220:["\\","|"],186:[";",":"],222:["'",'"'],188:[",","<"],190:[".",">"],191:["/","?"],192:["`","~"]},h=["shift","ctrl","alt"];function u(t){var e=(t=t||window.event).keyCode||t.which,n=d[e]||e;if(n){n.constructor!==Array&&(n=[n,n]);var o=n[0],i=t.shiftKey?"shift+":"",r=t.altKey?"alt+":"",s="",a=(t.ctrlKey?"ctrl+":"")+i+r;h.indexOf(n[0])>=0&&(n[0]=n[1]="");var l=t.code=="Key"+t.key&&!i;return s=a+(""==a&&l?n[1]:n[0]),""==n[0]&&(s=s.replace(/\+$/,"")),""==s?o:s}}for(var b=[["白","rgb(255, 255, 255)"],["漆黑","rgb(13, 0, 21)"],["红","rgb(254, 44, 35)"],["橙","rgb(255, 153, 0)"],["黄","rgb(255, 217, 0)"],["葱绿","rgb(163, 224, 67)"],["湖蓝","rgb(55, 217, 240)"],["天色","rgb(77, 168, 238)"],["藤紫","rgb(149, 111, 231)"],["白练","rgb(243, 243, 244)"],["白鼠","rgb(204, 204, 204)"],["樱","rgb(254, 242, 240)"],["镐","rgb(254, 245, 231)"],["练","rgb(254, 252, 217)"],["芽","rgb(237, 246, 232)"],["水","rgb(230, 250, 250)"],["缥","rgb(235, 244, 252)"],["丁香","rgb(240, 237, 246)"],["灰青","rgb(215, 216, 217)"],["鼠","rgb(165, 165, 165)"],["虹","rgb(251, 212, 208)"],["落柿","rgb(255, 215, 185)"],["花叶","rgb(249, 237, 166)"],["白绿","rgb(212, 233, 214)"],["天青","rgb(199, 230, 234)"],["天空","rgb(204, 224, 241)"],["水晶","rgb(218, 213, 233)"],["薄纯","rgb(123, 127, 131)"],["墨","rgb(73, 73, 73)"],["甚三红","rgb(238, 121, 118)"],["珊瑚","rgb(250, 165, 115)"],["金","rgb(230, 179, 34)"],["薄青","rgb(152, 192, 145)"],["白群","rgb(121, 198, 205)"],["薄花","rgb(110, 170, 215)"],["紫苑","rgb(156, 142, 193)"],["石墨","rgb(65, 70, 75)"],["黑","rgb(51, 51, 51)"],["绯红","rgb(190, 26, 29)"],["棕黄","rgb(185, 85, 20)"],["土黄","rgb(173, 114, 14)"],["苍翠","rgb(28, 114, 49)"],["孔雀","rgb(28, 120, 146)"],["琉璃","rgb(25, 67, 156)"],["青莲","rgb(81, 27, 120)"]],f="<div class='color-view' open-web-excel>",m=0;m<b.length;m++)f+="<div class='color-item' open-web-excel><span title='"+b[m][0]+"' open-web-excel style='background:"+b[m][1]+"'> </span></div>";var g=f+="</div>";var y=function t(e){var n=this;if(!(this instanceof t))throw new Error("Open-Web-Excel is a constructor and should be called with the `new` keyword");if(!s(e.el))throw new Error("options.el is not a element!");this.__el=e.el,this.__contentArray=this.$$formatContent(e.content),this.__region=null,this.__format=!1,this.$$renderKeyboard(),this.$$initDom(),this.$$createdMenu(),this.$$initView(),this.valueOf=function(){return{version:"v1",filename:"Open-Web-Excel",contents:n.__contentArray}}};y.prototype.$$formatContent=function(t){if(t&&"version"in t&&"Open-Web-Excel"==t.filename)return t.contents;for(var e=[],n=0;n<100;n++){for(var o=[],i=0;i<30;i++)o.push(this.$$newItemData());e.push(o)}return[{name:"未命名",content:e}]},y.prototype.$$calcColName=function(t){if(!r(t))return t;for(var e=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],n="";;){if(n=e[t%26]+n,0==(t=Math.floor(t/26)))break;t-=1}return n},y.prototype.$$addStyle=function(){"open-web-excel@style"in window||(window["open-web-excel@style"]={});var t=document.head||document.getElementsByTagName("head")[0];return function(e,n){if(window["open-web-excel@style"][e]);else{window["open-web-excel@style"][e]=!0;var o=document.createElement("style");o.setAttribute("type","text/css"),o.innerHTML=function(t){var e="open-web-excel";t=(t=t.replace(/( {0,}){/g,"{")).replace(/( {0,}),/g,",");for(var n="",o=!1,i=!1,r=!1,s=0;s<t.length;s++)":"!=t[s]||o||r||i?"{"!=t[s]||o?"}"!=t[s]||o?"/"==t[s]&&"*"==t[s+1]?o=!0:"*"==t[s]&&"/"==t[s+1]?o=!1:","!=t[s]||o||i||(r||(n+="["+e+"]"),r=!1):(i=!1,r=!1):(i=!0,r||(n+="["+e+"]")):(r=!0,n+="["+e+"]"),n+=t[s];return n}("/*\n    Style[".concat(e,"] for Open-Web-Excel\n    https://www.npmjs.com/package/open-web-excel\n*/\n            ")+n),t.appendChild(o)}}}(),y.prototype.$$styleToString=function(t){var e="";for(var n in t)e+=n+":"+t[n]+";";return e},y.prototype.$$newItemData=function(){return{value:" ",colspan:"1",rowspan:"1",style:{display:"table-cell",color:"black",background:"white","vertical-align":"top","text-align":"left","font-weight":"normal","font-style":"normal","text-decoration":"none"}}},y.prototype.$$itemClickHandler=function(t){if(1==this.__format){for(var e=l.find(this.__contentDom[this.__tableIndex],(function(){return!0}),"tr"),n=this.__contentArray[this.__tableIndex].content[+c(t).getAttribute("row")-1][+c(t).getAttribute("col")-1].style,o=this.__region.info.row[0];o<=this.__region.info.row[1];o++)for(var i=l.find(e[o],(function(){return!0}),"th"),r=this.__region.info.col[0];r<=this.__region.info.col[1];r++)for(var s in n)i[r].style[s]=n[s],this.__contentArray[this.__tableIndex].content[o-1][r-1].style[s]=n[s];this.__format=!1,l.removeClass(l.find(this.__menuQuickDom,(function(t){return"format"==t.getAttribute("def-type")}),"span")[0],"active")}this.$$moveCursorTo(c(t),+c(t).getAttribute("row"),+c(t).getAttribute("col"))},y.prototype.$$itemInputHandler=function(t){this.__contentArray[this.__tableIndex].content[+c(t).getAttribute("row")-1][+c(t).getAttribute("col")-1].value=c(t).innerText},y.prototype.$$getLeftTop=function(t,e){for(var n=this.__contentArray[this.__tableIndex].content,o=t;o>=1;o--)for(var i=e;i>=1;i--)if("none"!=n[o-1][i-1].style.display){if(n[o-1][i-1].rowspan- -o>t&&n[o-1][i-1].colspan- -i>e)return{row:o,col:i,content:n[o-1][i-1]};break}},y.prototype.$$initDom=function(){this.__el.innerHTML="",l.setStyles(this.__el,{"background-color":"#f7f7f7","user-select":"none"})},y.prototype.$$initView=function(){var t=this;this.__contentDom=[],this.__tableFrame=l.append(this.__el,"<div></div>"),l.setStyles(this.__tableFrame,{width:"100%",height:"calc(100% - 92px)",overflow:"auto"});for(var e=0;e<this.__contentArray.length;e++)this.$$initTableView(this.__contentArray[e],e,this.$$styleToString),l.setStyles(this.__contentDom[e],{display:0==e?"table":"none"});this.$$addStyle("excel-view","\n\n        .excel-view{\n            border-collapse: collapse;\n            width: 100%;\n        }\n\n        .excel-view .top-left{\n            border: 1px solid #d6cccb;\n            border-right:none;\n            background-color:white;\n        }\n\n        .excel-view .top-name{\n            border: 1px solid #d6cccb;\n            border-bottom:none;\n            color:gray;\n            font-size:12px;\n        }\n\n        .excel-view .line-num{\n            padding:0 5px;\n            border: 1px solid #d6cccb;\n            border-right:none;\n            color:gray;\n            font-size:12px;\n        }\n\n        .excel-view .item{\n            min-width:50px;\n            white-space: nowrap;\n            border:0.5px solid rgba(85,85,85,0.5);\n            outline:none;\n            font-size:12px;\n            padding:2px;\n        }\n\n        .excel-view .item[active='yes']{\n            outline: 2px dashed red;\n        }\n\n    ");var n=l.append(this.__el,"<div class='bottom-btn' open-web-excel></div>"),o=l.append(n,"<span class='add item' open-web-excel>+</span>");l.bind(o,"click",(function(){t.__contentArray.push(t.$$formatContent()[0]);var e=t.__contentArray.length-1;t.$$initTableView(t.__contentArray[e],e,t.$$styleToString);var o=l.append(n,"<span class='name item' open-web-excel>"+t.__contentArray[e].name+"</span>");t.__btnDom.push(o),l.bind(o,"click",(function(){_(t,e)}))})),this.__btnDom=[];for(var i=function(e){var o=l.append(n,"<span class='name item' open-web-excel>"+t.__contentArray[e].name+"</span>");l.bind(o,"click",(function(){_(t,e)})),l.bind(o,"dblclick",(function(){t.__btnDom[e].setAttribute("contenteditable","true")})),l.bind(o,"blur",(function(){t.__contentArray[e].name=o.innerText})),t.__btnDom.push(o)},r=0;r<this.__contentArray.length;r++)i(r);this.$$addStyle("bottom-btn","\n\n        .bottom-btn{\n            width: 100%;\n            height: 30px;\n            overflow: auto;\n            border-top: 1px solid #d6cccb;\n            box-sizing: border-box;\n        }\n\n        .bottom-btn .item{\n            line-height: 30px;\n            box-sizing: border-box;\n            vertical-align: top;\n            display: inline-block;\n            cursor: pointer;\n        }\n\n        .bottom-btn .add{\n            width: 30px;\n            text-align: center;\n            font-size: 18px;\n        }\n\n        .bottom-btn .name{\n            font-size: 12px;\n            padding: 0 10px;\n        }\n        .bottom-btn .name:focus{\n            outline:none;\n        }\n\n        .bottom-btn .name:hover{\n            background-color:#efe9e9;\n        }\n\n        .bottom-btn .name[active='yes']{\n            background-color:white;\n        }\n\n    "),this.__btnDom[0].click()},y.prototype.$$initTableView=function(t,e,n){var o=this,i="";i+="<tr><th class='top-left' open-web-excel></th>";for(var r=0;r<t.content[0].length;r++)i+="<th class='top-name' open-web-excel>"+this.$$calcColName(r)+"</th>";i+="</tr>";for(var s=0;s<t.content.length;s++){i+="<tr><th class='line-num' open-web-excel>"+(s+1)+"</th>";for(var a=0;a<t.content[s].length;a++)i+="<th\n                row='".concat(s+1,"'\n                col='").concat(a+1,'\'\n                contenteditable="true"\n                class="item"\n                colspan="').concat(t.content[s][a].colspan,'"\n                rowspan="').concat(t.content[s][a].rowspan,'"\n                style="').concat(n(t.content[s][a].style),'"\n            open-web-excel>').concat(t.content[s][a].value,"</th>");i+="</tr>"}this.__contentDom[e]=l.append(this.__tableFrame,"<table style='display:none;' class='excel-view' open-web-excel>"+i+"</table>");var c=l.find(this.__contentDom[e],(function(t){return l.hasClass(t,"item")}),"th");l.bind(c,"click",(function(t){o.$$itemClickHandler(t)})),l.bind(c,"input",(function(t){o.$$itemInputHandler(t)}))},y.prototype.$$createdMenu=function(){var t=this,e=l.append(this.__el,"<div class='top-dom' open-web-excel></div>");this.$$addStyle("top-dom","\n\n       .top-dom{\n            width: 100%;\n            height: 62px;\n            overflow: hidden;\n       }\n\n    "),this.__menuDom=l.append(e,"<div class='menu' open-web-excel>\n        <span open-web-excel>\n            操作\n            <div open-web-excel>\n                <span class='item more' open-web-excel>\n                    插入\n                    <div open-web-excel>\n                        <span class='item' open-web-excel>\n                            <span def-type='insert-up'>向上插入</span>\n                            <input value='1' open-web-excel />\n                            <span def-type='insert-up'>行</span>\n                        </span>\n                        <span class='item' open-web-excel>\n                            <span def-type='insert-down'>向下插入</span>\n                            <input value='1' open-web-excel />\n                            <span def-type='insert-down'>行</span>\n                        </span>\n                        <span class='item' open-web-excel>\n                            <span def-type='insert-left'>向左插入</span>\n                            <input value='1' open-web-excel />\n                            <span def-type='insert-left'>列</span>\n                        </span>\n                        <span class='item' open-web-excel>\n                            <span def-type='insert-right'>向右插入</span>\n                            <input value='1' open-web-excel />\n                            <span def-type='insert-right'>列</span>\n                        </span>\n                    </div>\n                </span>\n                <span class='item more' open-web-excel>\n                    删除\n                    <div open-web-excel>\n                        <span class='item' open-web-excel def-type='delete-row'>\n                            删除当前行\n                        </span>\n                        <span class='item' open-web-excel def-type='delete-col'>\n                            删除当前列\n                        </span>\n                    </div>\n                </span>\n                <span class='item more' open-web-excel>\n                    合并单元格\n                    <div open-web-excel>\n                        <span class='item' def-type='merge-all' open-web-excel>全部合并</span>\n                        <span class='item' def-type='merge-cancel' open-web-excel>取消合并</span>\n                    </div>\n                </span>\n            </div>\n        </span>\n        <span open-web-excel>\n            格式\n            <div open-web-excel>\n                <span class='item' def-type='bold' open-web-excel>粗体</span>\n                <span class='item' def-type='italic' open-web-excel>斜体</span>\n                <span class='item' def-type='underline' open-web-excel>下划线</span>\n                <span class='item' def-type='line-through' open-web-excel>中划线</span>\n                <span class='line' open-web-excel></span>\n                <span class='item more' open-web-excel>\n                    水平对齐\n                    <div open-web-excel>\n                        <span class='item' def-type='horizontal-left' open-web-excel>左对齐</span>\n                        <span class='item' def-type='horizontal-center' open-web-excel>居中对齐</span>\n                        <span class='item' def-type='horizontal-right' open-web-excel>右对齐</span>\n                    </div>\n                </span>\n                <span class='item more' open-web-excel>\n                    垂直对齐\n                    <div open-web-excel>\n                        <span class='item' def-type='vertical-top' open-web-excel>顶部对齐</span>\n                        <span class='item' def-type='vertical-middle' open-web-excel>居中对齐</span>\n                        <span class='item' def-type='vertical-bottom' open-web-excel>底部对齐</span>\n                    </div>\n                </span>\n            </div>\n        </span>\n        <span open-web-excel>\n            帮助\n            <div open-web-excel>\n                <span class='item' open-web-excel>\n                    <a href='https://github.com/hai2007/Open-Web-Excel/issues' open-web-excel target='_blank'>问题反馈</a>\n                </span>\n            </div>\n        </span>\n    </div>"),this.$$addStyle("menu",'\n\n        .menu{\n            border-bottom: 1px solid #d6cccb;\n            padding: 0 20px;\n            box-sizing: border-box;\n            white-space: nowrap;\n        }\n\n        .menu>span{\n            display: inline-block;\n            line-height: 26px;\n            padding: 0 10px;\n            font-size: 12px;\n            cursor: pointer;\n            color: #555555;\n        }\n        .menu>span:hover{\n            background: white;\n        }\n\n        .menu>span>div{\n            margin-left: -10px;\n        }\n\n        .menu>span div{\n            position:absolute;\n            background: white;\n            width: 140px;\n            box-shadow: 4px 3px 6px 0 #c9c9e2;\n            display:none;\n            padding:5px 0;\n        }\n\n        .menu>span div span{\n            display:block;\n            position:relative;\n            padding:5px 20px;\n        }\n\n        .menu>span div span>div{\n            left:140px;\n            top:0px;\n        }\n\n        .menu .line{\n            height:1px;\n            background-color:#d6cccb;\n            padding:0;\n            margin:0 10px;\n        }\n\n        .menu input{\n            width:20px;\n            outline:none;\n        }\n\n        .menu span:hover>div{\n            display:block;\n        }\n\n        .menu span.more:after{\n            content:">";\n            position: absolute;\n            right: 12px;\n            font-weight: 800;\n        }\n\n        .menu a{\n            text-decoration: none;\n            color: #555555;\n        }\n\n        .menu input{\n            width:20px;\n            outline:none;\n        }\n\n        .menu .item.active::before{\n            content: "*";\n            color: red;\n            position: absolute;\n            left: 8px;\n        }\n\n        .menu .item{\n            text-decoration: none;\n        }\n\n        .menu .item:hover{\n            text-decoration: underline;\n        }\n\n    '),this.__menuQuickDom=l.append(e,"<div class='quick-menu' open-web-excel>\n        <span class='item' def-type='format' open-web-excel>格式刷</span>\n        <span class='line' open-web-excel></span>\n        <span class='item color' def-type='font-color' open-web-excel>\n            文字颜色：<i class='color' open-web-excel></i>\n            ".concat(g,"\n        </span>\n        <span class='item color' def-type='background-color' open-web-excel>\n            填充色：<i class='color' open-web-excel></i>\n            ").concat(g,"\n        </span>\n        <span class='line' open-web-excel></span>\n        <span class='item' def-type='merge-all' open-web-excel>\n            全部合并\n        </span>\n        <span class='item' def-type='merge-cancel' open-web-excel>\n            取消合并\n        </span>\n        <span class='line' open-web-excel></span>\n        <span class='item' def-type='horizontal-left' open-web-excel>\n            左对齐\n        </span>\n        <span class='item' def-type='horizontal-center' open-web-excel>\n            居中对齐\n        </span>\n        <span class='item' def-type='horizontal-right' open-web-excel>\n            右对齐\n        </span>\n        <span class='line' open-web-excel></span>\n        <span class='item' def-type='vertical-top' open-web-excel>\n            顶部对齐\n        </span>\n        <span class='item' def-type='vertical-middle' open-web-excel>\n            居中对齐\n        </span>\n        <span class='item' def-type='vertical-bottom' open-web-excel>\n            底部对齐\n        </span>\n    </div>")),this.$$addStyle("quick-menu","\n\n        .quick-menu{\n            line-height: 36px;\n            font-size: 12px;\n            white-space: nowrap;\n            width: 100%;\n            overflow: auto;\n        }\n\n        .quick-menu span{\n            display:inline-block;\n            vertical-align: top;\n        }\n\n        .quick-menu span>i.color{\n            display: inline-block;\n            height: 14px;\n            width: 20px;\n            border:1px solid #d6cccb;\n            vertical-align: middle;\n        }\n\n        .quick-menu .item{\n            margin:0 10px;\n            cursor: pointer;\n        }\n\n        .quick-menu .line{\n            background-color:#d6cccb;\n            width:1px;\n            height:22px;\n            margin-top:7px;\n        }\n\n        .quick-menu .item:hover{\n            font-weight: 800;\n        }\n\n        .quick-menu .item.active{\n            font-weight: 800;\n            color: red;\n        }\n\n        /* 选择颜色 */\n\n        .color-view{\n            font-size: 0px;\n            width: 171px;\n            position: absolute;\n            padding: 10px;\n            box-sizing: content-box;\n            background: #fefefe;\n            box-shadow: 1px 1px 5px #9e9695;\n            line-height:1em;\n            display:none;\n            margin-top: -5px;\n            white-space: normal;\n        }\n\n        .color:hover>.color-view, .color-view:hover{\n            display:block;\n        }\n\n        .color-item{\n            display: inline-block;\n            width: 19px;\n            height: 19px;\n        }\n\n        .color-item>span{\n            width: 15px;\n            height: 15px;\n            margin: 2px;\n            cursor: pointer;\n            box-sizing: border-box;\n        }\n\n        .color-item>span:hover{\n            outline:1px solid black;\n        }\n\n    ");var n=l.find(e,(function(t){return t.getAttribute("def-type")}),"span");l.bind(n,"click",(function(e){var n=c(e),o=n.getAttribute("def-type");if("format"==o)null!=t.__region&&(t.__format=!0,l.addClass(l.find(t.__menuQuickDom,(function(t){return"format"==t.getAttribute("def-type")}),"span")[0],"active"));else if("bold"==o)t.$$setItemStyle("font-weight",l.hasClass(n,"active")?"normal":"bold");else if("italic"==o)t.$$setItemStyle("font-style",l.hasClass(n,"active")?"normal":"italic");else if("line-through"==o)t.$$setItemStyle("text-decoration",l.hasClass(n,"active")?"none":"line-through");else if("underline"==o)t.$$setItemStyle("text-decoration",l.hasClass(n,"active")?"none":"underline");else if(/^horizontal\-/.test(o))t.$$setItemStyle("text-align",o.replace("horizontal-",""));else if(/^vertical\-/.test(o))t.$$setItemStyle("vertical-align",o.replace("vertical-",""));else if(/^merge\-/.test(o)){if(null==t.__region)return;if("merge-all"==o){if(t.__region.nodes.length<=1)return;for(var i=1;i<t.__region.nodes.length;i++)t.__contentArray[t.__tableIndex].content[t.__region.nodes[i].getAttribute("row")-1][t.__region.nodes[i].getAttribute("col")-1].style.display="none",t.__contentArray[t.__tableIndex].content[t.__region.nodes[i].getAttribute("row")-1][t.__region.nodes[i].getAttribute("col")-1].value=" ",t.__region.nodes[i].style.display="none";t.__region.nodes=[t.__region.nodes[0]],t.__contentArray[t.__tableIndex].content[t.__region.nodes[0].getAttribute("row")-1][t.__region.nodes[0].getAttribute("col")-1].colspan=t.__region.info.col[1]-t.__region.info.col[0]+1+"",t.__contentArray[t.__tableIndex].content[t.__region.nodes[0].getAttribute("row")-1][t.__region.nodes[0].getAttribute("col")-1].rowspan=t.__region.info.row[1]-t.__region.info.row[0]+1+"",t.__region.nodes[0].setAttribute("colspan",t.__region.info.col[1]-t.__region.info.col[0]+1+""),t.__region.nodes[0].setAttribute("rowspan",t.__region.info.row[1]-t.__region.info.row[0]+1+""),t.__region.nodes[0].click()}else if("merge-cancel"==o){for(var r=l.find(t.__contentDom[t.__tableIndex],(function(){return!0}),"tr"),s=t.__region.info.row[0];s<=t.__region.info.row[1];s++)for(var a=l.find(r[s],(function(){return!0}),"th"),p=t.__region.info.col[0];p<=t.__region.info.col[1];p++)a[p].style.display="table-cell",a[p].setAttribute("colspan","1"),a[p].setAttribute("rowspan","1"),t.__contentArray[t.__tableIndex].content[s-1][p-1].style.display="table-cell",t.__contentArray[t.__tableIndex].content[s-1][p-1].colspan="1",t.__contentArray[t.__tableIndex].content[s-1][p-1].rowspan="1";t.$$cancelRegion(),t.__region=null}}else if(/^insert\-/.test(o)){var _=+l.find(n.parentNode,(function(){return!0}),"input")[0].value;if("insert-up"==o)for(var d=0;d<_;d++)t.$$insertUpNewRow();else if("insert-down"==o)for(var h=0;h<_;h++)t.$$insertDownNewRow();else if("insert-left"==o)for(var u=0;u<_;u++)t.$$insertLeftNewCol();else if("insert-right"==o)for(var b=0;b<_;b++)t.$$insertRightNewCol()}else/^delete\-/.test(o)&&("delete-row"==o?t.$$deleteCurrentRow():"delete-col"==o&&t.$$deleteCurrentCol())}));for(var o=l.find(e,(function(t){return l.hasClass(t,"color")}),"span"),i=function(e){var n=l.find(o[e],(function(){return!0}),"span");l.bind(n,"click",(function(n){var i=o[e].getAttribute("def-type"),r=c(n).style.background;t.$$setItemStyle({"background-color":"background","font-color":"color"}[i],r)}))},r=0;r<o.length;r++)i(r)},y.prototype.$$updateMenu=function(t){for(var e=l.find(this.__menuDom,(function(t){return t.getAttribute("def-type")}),"span"),n=0;n<e.length;n++){var o=e[n].getAttribute("def-type");"bold"==o?"bold"==t["font-weight"]?l.addClass(e[n],"active"):l.removeClass(e[n],"active"):"italic"==o?"italic"==t["font-style"]?l.addClass(e[n],"active"):l.removeClass(e[n],"active"):"underline"==o?"underline"==t["text-decoration"]?l.addClass(e[n],"active"):l.removeClass(e[n],"active"):"line-through"==o?"line-through"==t["text-decoration"]?l.addClass(e[n],"active"):l.removeClass(e[n],"active"):/^horizontal\-/.test(o)?o=="horizontal-"+t["text-align"]?l.addClass(e[n],"active"):l.removeClass(e[n],"active"):/^vertical\-/.test(o)&&(o=="vertical-"+t["vertical-align"]?l.addClass(e[n],"active"):l.removeClass(e[n],"active"))}for(var i=l.find(this.__menuQuickDom,(function(t){return t.getAttribute("def-type")}),"span"),r=0;r<i.length;r++){var s=i[r].getAttribute("def-type");"font-color"==s?i[r].getElementsByTagName("i")[0].style.backgroundColor=t.color:"background-color"==s?i[r].getElementsByTagName("i")[0].style.backgroundColor=t.background:/^horizontal\-/.test(s)?s=="horizontal-"+t["text-align"]?l.addClass(i[r],"active"):l.removeClass(i[r],"active"):/^vertical\-/.test(s)&&(s=="vertical-"+t["vertical-align"]?l.addClass(i[r],"active"):l.removeClass(i[r],"active"))}},y.prototype.$$moveCursorTo=function(t,e,n){if(null!=this.__region&&(this.$$cancelRegion(),this.__region=null),this.__keyLog.shift)this.__region=this.$$calcRegionInfo({row:this.__rowNum,col:this.__colNum,rowNum:+this.__target.getAttribute("rowspan"),colNum:+this.__target.getAttribute("colspan")},{row:e,col:n,rowNum:+t.getAttribute("rowspan"),colNum:+t.getAttribute("colspan")}),this.$$showRegion();else{s(this.__target)&&this.__target.setAttribute("active","no"),this.__rowNum=e,this.__colNum=n,this.__target=t;var o=this.__contentArray[this.__tableIndex].content[e-1][n-1];this.$$updateMenu(o.style),t.setAttribute("active","yes")}},y.prototype.$$setItemStyle=function(t,e){this.__contentArray[this.__tableIndex].content[this.__rowNum-1][this.__colNum-1].style[t]=e,this.__target.style[t]=e,this.$$updateMenu(this.__contentArray[this.__tableIndex].content[this.__rowNum-1][this.__colNum-1].style)},y.prototype.$$calcRegionInfo=function(t,e){var n={info:{},nodes:[]},o=t.row,i=t.row+t.rowNum-1,r=e.row,s=e.row+e.rowNum-1,a=o>r?r:o,l=i>s?i:s,c=t.col,p=t.col+t.colNum-1,_=e.col,d=e.col+e.colNum-1,h=c>_?_:c,u=p>d?p:d;n.info={row:[a,l],col:[h,u]};for(var b=this.__contentDom[this.__tableIndex].getElementsByTagName("tr"),f=a;f<=l;f++)for(var m=b[f].getElementsByTagName("th"),g=1;g<m.length;g++){var y=m[g].getAttribute("col");if(y>=h&&y<=u)n.nodes.push(m[g]);else if(y>u)break}return n},y.prototype.$$showRegion=function(){for(var t=0;t<this.__region.nodes.length;t++)this.__region.nodes[t].style.background="#e5e0e0"},y.prototype.$$cancelRegion=function(){for(var t=0;t<this.__region.nodes.length;t++)this.__region.nodes[t].style.background=this.__contentArray[this.__tableIndex].content[this.__region.nodes[t].getAttribute("row")-1][this.__region.nodes[t].getAttribute("col")-1].style.background},y.prototype.$$insertUpNewRow=function(){var t=this,e=l.find(this.__contentDom[this.__tableIndex],(function(){return!0}),"tr"),n=l.before(e[this.__rowNum],'<tr><th class="line-num" open-web-excel>'+this.__rowNum+"</th></tr>");e.splice(this.__rowNum,0,n),this.__contentArray[this.__tableIndex].content.splice(this.__rowNum-1,0,[]);for(var o=this.__rowNum+1;o<=e.length-1;o++){var i=l.find(e[o],(function(){return!0}),"th");i[0].innerText=o;for(var r=1;r<i.length;r++)i[r].setAttribute("row",o)}for(var s=1;s<=this.__contentArray[this.__tableIndex].content[1==this.__rowNum?1:0].length;s++){var a=this.$$newItemData(),c=this.__contentArray[this.__tableIndex].content[this.__rowNum][s-1];if(1!=this.__rowNum&&"none"==c.style.display){for(var p=!1,_=s-1;_>=1;_--){var d=this.__contentArray[this.__tableIndex].content[this.__rowNum][_-1];if("none"!=d.style.display){_- -d.colspan>s&&(p=!0);break}}if(!p)if(a.style.display="none",1==s||"none"!=this.__contentArray[this.__tableIndex].content[this.__rowNum][s-2].style.display)for(var h=this.__rowNum-1;h>0;h--)if("none"!=this.__contentArray[this.__tableIndex].content[h-1][s-1].style.display){this.__contentArray[this.__tableIndex].content[h-1][s-1].rowspan-=-1;var u=l.find(e[h],(function(){return!0}),"th")[s];u.setAttribute("rowspan",u.getAttribute("rowspan")- -1);break}}this.__contentArray[this.__tableIndex].content[this.__rowNum-1].push(a);var b=l.append(n,'<th row="'.concat(this.__rowNum,'" col="').concat(s,'" contenteditable="true" class="item" colspan="1" rowspan="1" style="').concat(this.$$styleToString(a.style),'" open-web-excel></th>'));l.bind(b,"click",(function(e){t.$$itemClickHandler(e)})),l.bind(b,"input",(function(e){t.$$itemInputHandler(e)}))}this.__rowNum+=1},y.prototype.$$insertDownNewRow=function(){var t=this,e=l.find(this.__contentDom[this.__tableIndex],(function(){return!0}),"tr"),n=l.after(e[this.__rowNum],'<tr><th class="line-num" open-web-excel>'+(this.__rowNum+1)+"</th></tr>");e.splice(this.__rowNum+1,0,n),this.__contentArray[this.__tableIndex].content.splice(this.__rowNum,0,[]);for(var o=this.__rowNum+2;o<=e.length-1;o++){var i=l.find(e[o],(function(){return!0}),"th");i[0].innerText=o;for(var r=1;r<i.length;r++)i[r].setAttribute("row",o)}for(var s=1;s<=this.__contentArray[this.__tableIndex].content[0].length;s++){var a=this.$$newItemData();if(this.__rowNum!=this.__contentArray[this.__tableIndex].content.length-1){var c=this.__contentArray[this.__tableIndex].content[this.__rowNum-1][s-1];if("none"==c.style.display||"1"!=c.rowspan){var p=this.$$getLeftTop(this.__rowNum,s);if(p.row- -p.content.rowspan-1>this.__rowNum&&(a.style.display="none",p.col==s)){this.__contentArray[this.__tableIndex].content[p.row-1][p.col-1].rowspan-=-1;var _=l.find(e[p.row],(function(){return!0}),"th")[p.col];_.setAttribute("rowspan",_.getAttribute("rowspan")- -1)}}}this.__contentArray[this.__tableIndex].content[this.__rowNum].push(a);var d=l.append(n,'<th row="'.concat(this.__rowNum,'" col="').concat(s,'" contenteditable="true" class="item" colspan="1" rowspan="1" style="').concat(this.$$styleToString(a.style),'" open-web-excel></th>'));l.bind(d,"click",(function(e){t.$$itemClickHandler(e)})),l.bind(d,"input",(function(e){t.$$itemInputHandler(e)}))}},y.prototype.$$insertLeftNewCol=function(){var t=this,e=l.find(this.__contentDom[this.__tableIndex],(function(){return!0}),"tr");l.append(e[0],"<th class='top-name' open-web-excel>"+this.$$calcColName(this.__contentArray[this.__tableIndex].content[0].length)+"</th>");for(var n=1;n<e.length;n++){for(var o=l.find(e[n],(function(){return!0}),"th"),i=this.__colNum;i<o.length;i++)o[i].setAttribute("col",i+1);var r=this.$$newItemData(),s=this.__contentArray[this.__tableIndex].content[n-1][this.__colNum-1];if(1!=this.__colNum&&"none"==s.style.display){for(var a=!1,c=n-1;c>=1;c--){var p=this.__contentArray[this.__tableIndex].content[c-1][this.__colNum];if("none"!=p.style.display){c- -p.rowspan>n&&(a=!0);break}}if(!a)if(r.style.display="none",1==n||"none"!=this.__contentArray[this.__tableIndex].content[n-2][this.__colNum].style.display)for(var _=this.__colNum-1;_>0;_--)if("none"!=this.__contentArray[this.__tableIndex].content[n-1][_-1].style.display){this.__contentArray[this.__tableIndex].content[n-1][_-1].colspan-=-1;var d=l.find(e[n],(function(){return!0}),"th")[_];d.setAttribute("colspan",d.getAttribute("colspan")- -1);break}}this.__contentArray[this.__tableIndex].content[n-1].splice(this.__colNum-1,0,r);var h=l.before(o[this.__colNum],'<th row="'.concat(n,'" col="').concat(this.__colNum,'" contenteditable="true" class="item" colspan="1" rowspan="1" style="').concat(this.$$styleToString(r.style),'" open-web-excel></th>'));l.bind(h,"click",(function(e){t.$$itemClickHandler(e)})),l.bind(h,"input",(function(e){t.$$itemInputHandler(e)}))}this.__colNum+=1},y.prototype.$$insertRightNewCol=function(){var t=this,e=l.find(this.__contentDom[this.__tableIndex],(function(){return!0}),"tr");l.append(e[0],"<th class='top-name' open-web-excel>"+this.$$calcColName(this.__contentArray[this.__tableIndex].content[0].length)+"</th>");for(var n=1;n<e.length;n++){for(var o=l.find(e[n],(function(){return!0}),"th"),i=this.__colNum+1;i<o.length;i++)o[i].setAttribute("col",i+1);var r=this.$$newItemData();if(this.__colNum!=this.__contentArray[this.__tableIndex].content[0].length-1){var s=this.__contentArray[this.__tableIndex].content[n-1][this.__colNum-1];if("none"==s.style.display||"1"!=s.colspan){var a=this.$$getLeftTop(n,this.__colNum);if(a.col- -a.content.colspan-1>this.__colNum&&(r.style.display="none",a.row==n)){this.__contentArray[this.__tableIndex].content[a.row-1][a.col-1].colspan-=-1;var c=l.find(e[a.row],(function(){return!0}),"th")[a.col];c.setAttribute("colspan",c.getAttribute("colspan")- -1)}}}this.__contentArray[this.__tableIndex].content[n-1].splice(this.__colNum,0,r);var p=l.after(o[this.__colNum],'<th row="'.concat(n,'" col="').concat(this.__colNum+1,'" contenteditable="true" class="item" colspan="1" rowspan="1" style="').concat(this.$$styleToString(r.style),'" open-web-excel></th>'));l.bind(p,"click",(function(e){t.$$itemClickHandler(e)})),l.bind(p,"input",(function(e){t.$$itemInputHandler(e)}))}},y.prototype.$$deleteCurrentRow=function(){for(var t=l.find(this.__contentDom[this.__tableIndex],(function(){return!0}),"tr"),e=this.__rowNum+1;e<=this.__contentArray[this.__tableIndex].content.length;e++){var n=l.find(t[e],(function(){return!0}),"th");n[0].innerText=e-1;for(var o=1;o<n.length;o++)n[o].setAttribute("row",e-1)}var i;this.__rowNum==this.__contentArray[this.__tableIndex].content.length||(i=l.find(t[this.__rowNum+1],(function(){return!0}),"th"));for(var r=1;r<=this.__contentArray[this.__tableIndex].content[0].length;r++)if("none"==this.__contentArray[this.__tableIndex].content[this.__rowNum-1][r-1].style.display){for(var s=this.__rowNum-1;s>=1;s--)if("none"!=this.__contentArray[this.__tableIndex].content[s-1][r-1].style.display){if(s- -this.__contentArray[this.__tableIndex].content[s-1][r-1].rowspan>this.__rowNum){var a=this.__contentArray[this.__tableIndex].content[s-1][r-1].rowspan-1;l.find(t[s],(function(){return!0}),"th")[r].setAttribute("rowspan",a),this.__contentArray[this.__tableIndex].content[s-1][r-1].rowspan=a}break}}else if(this.__contentArray[this.__tableIndex].content[this.__rowNum-1][r-1].rowspan-1>0){var c=this.__contentArray[this.__tableIndex].content[this.__rowNum-1][r-1].rowspan-1,_=this.__contentArray[this.__tableIndex].content[this.__rowNum-1][r-1].colspan;i[r].setAttribute("rowspan",c),i[r].setAttribute("colspan",_),i[r].style.display="table-cell",this.__contentArray[this.__tableIndex].content[this.__rowNum][r-1].rowspan=c,this.__contentArray[this.__tableIndex].content[this.__rowNum][r-1].colspan=_,this.__contentArray[this.__tableIndex].content[this.__rowNum][r-1].style.display="table-cell"}p(t[this.__rowNum]),this.__contentArray[this.__tableIndex].content.splice(this.__rowNum-1,1),this.__btnDom[this.__tableIndex].click()},y.prototype.$$deleteCurrentCol=function(){for(var t=l.find(this.__contentDom[this.__tableIndex],(function(){return!0}),"tr"),e=1;e<=this.__contentArray[this.__tableIndex].content.length;e++)if("none"==this.__contentArray[this.__tableIndex].content[e-1][this.__colNum-1].style.display){for(var n=this.__colNum-1;n>=1;n--)if("none"!=this.__contentArray[this.__tableIndex].content[e-1][n-1].style.display){if(n- -this.__contentArray[this.__tableIndex].content[e-1][n-1].colspan>this.__colNum){var o=this.__contentArray[this.__tableIndex].content[e-1][n-1].colspan-1;l.find(t[e],(function(){return!0}),"th")[n].setAttribute("colspan",o),this.__contentArray[this.__tableIndex].content[e-1][n-1].colspan=o}break}}else if(this.__contentArray[this.__tableIndex].content[e-1][this.__colNum-1].colspan-1>0){var i=l.find(t[e],(function(){return!0}),"th")[this.__colNum+1],r=this.__contentArray[this.__tableIndex].content[e-1][this.__colNum-1].colspan-1,s=this.__contentArray[this.__tableIndex].content[e-1][this.__colNum-1].rowspan;i.setAttribute("colspan",r),i.setAttribute("rowspan",s),i.style.display="table-cell",this.__contentArray[this.__tableIndex].content[e-1][this.__colNum].colspan=r,this.__contentArray[this.__tableIndex].content[e-1][this.__colNum].rowspan=s,this.__contentArray[this.__tableIndex].content[e-1][this.__colNum].style.display="table-cell"}l.find(t[0],(function(){return!0}),"th")[this.__contentArray[this.__tableIndex].content[0].length].remove();for(var a=1;a<t.length;a++){for(var c=l.find(t[a],(function(){return!0}),"th"),_=this.__colNum+1;_<c.length;_++)c[_].setAttribute("col",_-1);p(c[this.__colNum]),this.__contentArray[this.__tableIndex].content[a-1].splice(this.__colNum-1,1)}this.__btnDom[this.__tableIndex].click()},y.prototype.$$renderKeyboard=function(){var t=this;"__keyLog"in this?console.error("Keyboard has been initialized"):(this.__keyLog={shift:!1},l.bind(document.body,"keydown",(function(e){"shift"==u(e)&&(t.__keyLog.shift=!0)})),l.bind(document.body,"keyup",(function(e){"shift"==u(e)&&(t.__keyLog.shift=!1)})))},"object"===e(t)&&"object"===e(t.exports)?t.exports=y:window.OpenWebExcel=y}()}).call(this,n(5)(t))}}]);